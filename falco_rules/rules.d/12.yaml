- macro: proc_is_new
  condition: evt.type = execve

- rule: Unauthorized_Mount
  desc: Detect unauthorized mount attempts
  condition: >
    proc_is_new and
    proc.name = mount and
    not proc.pname in (systemd, mount.nfs)
  output: "Unauthorized mount attempt detected (user=%user.name command=%proc.cmdline)"
  priority: WARNING
  tags:
    - filesystem
    - security

- rule: Prevent Write in Read-Only Containers
  desc: Detects if a specific read-only container tries to write
  condition: >
    evt.type in (write, creat, open, openat) and
    container.name = "container_ro" and
    fd.name startswith "/mnt" and
    (evt.type != open and evt.type != openat or (evt.is_open_write = true))
  output: "Read-only container (Name: %container.name, ID: %container.id) tried to write to %fd.name"
  priority: CRITICAL
  tags: [filesystem, security]
